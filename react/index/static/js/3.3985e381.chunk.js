"use strict";(self.webpackChunkarco_design_pro=self.webpackChunkarco_design_pro||[]).push([[3],{19672:function(e,t,r){r.r(t),r.d(t,{default:function(){return Y}});var n=r(93433),a=r(15861),o=r(1413),c=r(29439),u=r(87757),i=r.n(u),s=(r(47872),r(82357)),l=(r(56710),r(86721)),d=(r(63793),r(79721)),m=(r(4489),r(80325)),f=(r(58186),r(3024)),p=(r(35749),r(29413)),g=(r(81993),r(48848)),v=(r(7247),r(74354)),h=(r(84094),r(6438)),w=(r(96205),r(19837)),y=(r(2373),r(95635)),Z=(r(74450),r(65695)),E=r(4519),b=r(43270),x=r.n(b);function S(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"yyyy-mm-dd",n={y:(e=t?/^\d{10}$/.test(t.toString().trim())?new Date(1e3*t):"string"===typeof t&&/^\d+$/.test(t.trim())?new Date(Number(t)):new Date("string"===typeof t?t.replace(/-/g,"/"):t):new Date).getFullYear().toString(),m:(e.getMonth()+1).toString().padStart(2,"0"),d:e.getDate().toString().padStart(2,"0"),h:e.getHours().toString().padStart(2,"0"),M:e.getMinutes().toString().padStart(2,"0"),s:e.getSeconds().toString().padStart(2,"0")};for(var a in n){var o=new RegExp("".concat(a,"+")).exec(r)||[],u=(0,c.Z)(o,1),i=u[0];if(i){var s="y"===a&&2===i.length?2:0;r=r.replace(i,n[a].slice(s))}}return r}function k(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"s:0.00",a=t-e,o=n.split(":"),u=(0,c.Z)(o,2),i=u[0],s=u[1];if("s"==i){var l=a/1e3;"0.00"==s&&(r=T(l))}return r}function T(e){var t,r;if(0===e)return"0";var n=e.toString().split(".");return(null===(t=n[0])||void 0===t?void 0:t.padStart(1,"0"))+"."+((null===(r=n[1])||void 0===r?void 0:r.padEnd(2,"0"))||"00")}var N=r(15671),R=r(43144),C=function(){function e(t,r){(0,N.Z)(this,e),this.dbName=t,this.storeName=r,this.db=null}return(0,R.Z)(e,[{key:"open",value:function(){var e=(0,a.Z)(i().mark((function e(){var t=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var n=window.indexedDB.open(t.dbName,1);n.onerror=function(e){console.error("Failed to open database:",e.target.error),r(e.target.error)},n.onsuccess=function(r){t.db=r.target.result,e(t.db)},n.onupgradeneeded=function(e){var r=e.target.result;r.objectStoreNames.contains(t.storeName)||r.createObjectStore(t.storeName,{keyPath:"id",autoIncrement:!0}).createIndex("startTime","startTime",{unique:!1})}})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"addRecord",value:function(){var e=(0,a.Z)(i().mark((function e(t){var r=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.db){e.next=3;break}return e.next=3,this.open();case 3:return e.abrupt("return",new Promise((function(e,n){var a=r.db.transaction([r.storeName],"readwrite").objectStore(r.storeName).add(t);a.onerror=function(e){console.error("Failed to add record:",e.target.error),n(e.target.error)},a.onsuccess=function(t){e(t.target.result)}})));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getRecords",value:function(){var e=(0,a.Z)(i().mark((function e(){var t=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.db){e.next=3;break}return e.next=3,this.open();case 3:return e.abrupt("return",new Promise((function(e,r){var n=t.db.transaction([t.storeName],"readonly").objectStore(t.storeName).getAll();n.onerror=function(e){console.error("Failed to get records:",e.target.error),r(e.target.error)},n.onsuccess=function(t){e(t.target.result)}})));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"deleteRecord",value:function(){var e=(0,a.Z)(i().mark((function e(t){var r=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.db){e.next=3;break}return e.next=3,this.open();case 3:return e.abrupt("return",new Promise((function(e,n){var a=r.db.transaction([r.storeName],"readwrite").objectStore(r.storeName).delete(t);a.onerror=function(e){console.error("Failed to delete record:",e.target.error),n(e.target.error)},a.onsuccess=function(t){e(t.target.result)}})));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getRecordsByIndex",value:function(){var e=(0,a.Z)(i().mark((function e(t){var r,n,a=this;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.index,n=t.value,this.db){e.next=4;break}return e.next=4,this.open();case 4:return e.abrupt("return",new Promise((function(e,t){var o=a.db.transaction([a.storeName],"readwrite").objectStore(a.storeName).index(r).get(n);o.onerror=function(e){console.error("Failed to delete record:",e.target.error),t(e.target.error)},o.onsuccess=function(t){e(t.target.result)}})));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),D=r(14280),I=r(58428),_=(r(47223),r(61440)),j=r(79704),M=(r(45886),r(98029)),P=(r(36391),r(54565)),F=P.Z.Item,O=M.Z.Option,z=function(e){var t=function(e,t){var r={};return e.forEach((function(e){var n=new Date(new Date(e[t]).toLocaleDateString()).getTime();r[n]||(r[n]={data:[],sortType:"down"}),r[n].data.push(e)})),r}(e.data,"startTime"),r=e.deleteHandler;console.log(t);var n=(0,E.useState)(t),a=(0,c.Z)(n,2),o=a[0],u=a[1],i=Object.assign({},o),s=(0,E.useState)("0"),l=(0,c.Z)(s,2),d=l[0],m=l[1],g=[{name:"\u5f00\u59cb\u65f6\u95f4",value:"startTime"},{name:"\u6e38\u620f\u6210\u7ee9",value:"totalTime"}],v=(0,E.useState)("startTime"),h=(0,c.Z)(v,2),w=h[0],y=h[1],Z=(new C("game_records","records"),function(e){var t=e.data,n=e.fatherKey;return E.createElement(P.Z,{lazyload:!0,accordion:!0},t.map((function(e,a){var o="\u5927\u5c0f:  ".concat(e.guige," ---- \u5f00\u59cb\u65f6\u95f4: ").concat(S(e.startTime,"yyyy-mm-dd hh:MM:ss")," ---- \u6210\u7ee9: ").concat(e.totalTime,"s");return E.createElement(F,{header:o,name:"".concat(n,"-").concat(a),key:"".concat(n,"-").concat(a),extra:E.createElement(E.Fragment,null,E.createElement(p.Z,{type:"primary",status:"danger",shape:"circle",icon:E.createElement(j.Z,null),onClick:function(){r(t[a].startTime)}}))},E.createElement(_.Z,{size:"small",dataSource:e.records,render:function(t,r){return E.createElement(_.Z.Item,{key:r},function(){var n,a,o=(null===(n=e.records[r-1])||void 0===n?void 0:n.time)||(null===(a=e.records[0])||void 0===a?void 0:a.time);return"".concat(t.value," -- ").concat(k(o,t.time),"s")}())}}))})))});function b(e){var t="up"==i[e].sortType;i[e].sortType=t?"down":"up",i[e].data=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"up";return"up"==r?e.sort((function(e,r){return e[t]-r[t]})):"down"==r&&e.sort((function(e,r){return r[t]-e[t]})),console.log(e),e}(i[e].data,w,i[e].sortType),u(i)}return E.createElement(P.Z,{lazyload:!0,accordion:!0,style:{maxHeight:600,overflowY:"auto"},defaultActiveKey:"0",onChange:function(e){m(e)}},Object.keys(o).sort((function(e,t){return Number(t)-Number(e)})).map((function(e,t){var r=i[e],n=E.createElement(f.Z,null,E.createElement(M.Z,{placeholder:"\u9009\u62e9\u6392\u5e8f\u65b9\u5f0f",style:{width:154},defaultValue:g[0].value,onChange:function(e){y(e)}},g.map((function(e,t){return E.createElement(O,{key:e.value,value:e.value},e.name)}))),E.createElement(p.Z,{onClick:function(){b(e)},icon:"up"==r.sortType?E.createElement(I.Z,null):E.createElement(D.Z,null)},"up"==r.sortType?"\u964d\u5e8f":"\u5347\u5e8f"));return E.createElement(F,{header:S(e),name:""+t,extra:d==""+t&&n,key:e},E.createElement(Z,{data:r.data,fatherKey:t}))})))},A=Z.Z.Title,B=Z.Z.Paragraph,H=(y.Z.Item,w.Z.RangePicker,0),K=0,V="";function J(e){for(var t=[],r=0;r<e.length;r++)Array.isArray(e[r])?t=t.concat(J(e[r])):t.push(e[r]);return t}function Y(){var e=new C("game_records","records"),t=(0,E.useState)(2),r=(0,c.Z)(t,2),u=r[0],w=r[1],y=(0,E.useState)(2),b=(0,c.Z)(y,2),S=b[0],T=b[1],N=(0,E.useState)(0),R=(0,c.Z)(N,2),D=R[0],I=R[1],_=(0,E.useState)([]),j=(0,c.Z)(_,2),M=j[0],P=j[1],F=(0,E.useState)([]),O=(0,c.Z)(F,2),Y=O[0],$=O[1],q=(0,E.useState)([]),L=(0,c.Z)(q,2),U=L[0],W=L[1],G=(0,E.useState)(!0),Q=(0,c.Z)(G,2),X=Q[0],ee=Q[1],te=(0,E.useState)(!1),re=(0,c.Z)(te,2),ne=re[0],ae=re[1];function oe(){for(var e,t=function(e){for(var t=e.length-1;t>0;t--){var r=Math.floor(Math.random()*(t+1)),n=[e[r],e[t]];e[t]=n[0],e[r]=n[1]}return e}((e=S*u,Array.from({length:e},(function(e,t){return{value:t+1,status:"default",time:0}})))),r=[],n=0;n<u;n++)r.push(t.slice(S*n,S*(n+1)));$(r)}(0,E.useEffect)((function(){e.getRecords().then((function(e){P(e),console.log("\u6570\u636e\u5e93\u8bb0\u5f55:",e)}))}),[]),(0,E.useEffect)((function(){console.log("createData\u6267\u884c\u4e86"),I(u*S),oe()}),[u,S]);var ce={start:function(){H=(new Date).getTime()},end:function(e){K=(new Date).getTime(),V=k(H,K),this.saveIndexDB((0,o.Z)((0,o.Z)({},e),{},{time:V}))},saveRecord:function(e){var t=e.row,r=e.col,n=e.dataCopy,a=e.time,o=J(n).sort((function(e,t){return e.value-t.value})),c=localStorage.getItem("dwj_game_records"),u=[],i={guige:t+"*"+r,startTime:o[0].time,endTime:o[o.length-1].time,totalTime:a,records:o};c?(u=JSON.parse(c)).push(i):u=[i],P(u),localStorage.setItem("dwj_game_records",JSON.stringify(u))},saveIndexDB:function(t){var r=this;return(0,a.Z)(i().mark((function n(){var a,o,c,u,s,l;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=t.row,o=t.col,c=t.dataCopy,u=t.time,s=J(c).sort((function(e,t){return e.value-t.value})),n.next=4,e.getRecords();case 4:n.sent,l={guige:a+"*"+o,startTime:s[0].time,endTime:s[s.length-1].time,totalTime:u,records:s},e.addRecord(l),r.getRecords();case 8:case"end":return n.stop()}}),n)})))()},deleteRecord:function(t){e.getRecordsByIndex({index:"startTime",value:t}).then(function(){var t=(0,a.Z)(i().mark((function t(r){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.deleteRecord(r.id);case 2:return t.next=4,ce.getRecords();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){console.log(e),h.Z.error(""+e)}))},getRecords:function(){return(0,a.Z)(i().mark((function t(){var r;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getRecords();case 2:r=t.sent,console.log(r),P(r);case 5:case"end":return t.stop()}}),t)})))()}};function ue(e){var t=e.cols,r=e.rowIndex;function a(e,t,r){var a=e.value;if("default"==e.status){var o=Y.slice();if(1==a)ce.start(),W([a]),o[t][r].status="right",o[t][r].time=(new Date).getTime();else U[U.length-1]+1==a?(W([].concat((0,n.Z)(U),[a])),o[t][r].status="right",o[t][r].time=(new Date).getTime(),a==D&&ce.end({row:u,col:S,dataCopy:o})):o[t][r].status="wrong";$(o)}}function o(e,t,r){if("wrong"==e.status){var n=Y.slice();n[t][r].status="default",$(n)}}return E.createElement("div",{className:"row-item"},t.map((function(e,t){return E.createElement("button",{className:x()(["col-item",{right:"right"==e.status},{wrong:"wrong"==e.status}]),key:e.value,onMouseDown:function(){a(e,r,t)},onTouchStart:function(){a(e,r,t)},onMouseUp:function(){o(e,r,t)},onTouchEnd:function(){o(e,r,t)}},e.value)})))}function ie(){return ne?M.length>0?E.createElement(z,{data:M,deleteHandler:ce.deleteRecord}):E.createElement(v.Z,{description:"\u8fd8\u6ca1\u6709\u6e38\u620f\u5386\u53f2\uff01"}):E.createElement("div",null)}return E.createElement(s.Z,null,E.createElement(f.Z,{size:"large"},E.createElement(g.Z,{style:{width:160},mode:"button",prefix:"row",defaultValue:u,min:2,precision:0,onChange:function(e){var t=e;console.log(t),w(t?parseInt(t):0)}}),E.createElement(g.Z,{style:{width:160},mode:"button",prefix:"col",defaultValue:S,min:2,precision:0,onChange:function(e){T(e?parseInt(e):0)}}),E.createElement(p.Z,{onClick:oe},"\u5f00 \u59cb"),E.createElement(f.Z,null,E.createElement(p.Z,{onClick:function(){ae(!0)}},"\u6e38\u620f\u5386\u53f2")),E.createElement(f.Z,null,E.createElement("span",null,"\u663e\u793a\u65f6\u95f4: "),E.createElement(m.Z,{defaultChecked:!0,size:"small",onChange:function(){ee(!X)}}),X&&E.createElement("span",{className:"time"},"\u65f6\u95f4: ",V||0,"s\u2003"))),E.createElement(Z.Z,null,E.createElement(A,{heading:6,style:{marginTop:"20px"}},"\u6e38\u620f\u89c4\u5219"),E.createElement(B,null,"\u70b9\u51fb\u9875\u9762\u4e2d\u7684 ",E.createElement(d.Z,{bordered:!0},"\u5f00 \u59cb")," \u6309\u94ae,\u4f1a\u751f\u6210\u4e00\u5f20\u65b0\u7684\u8868\u683c, \u5f53\u4f60\u5728\u6309\u94ae ",E.createElement(d.Z,{bordered:!0},"1")," \u4e0a\u6309\u4e0b\u9f20\u6807\u65f6, \u6e38\u620f\u4f1a\u81ea\u52a8\u5f00\u59cb\u8ba1\u65f6, \u76f4\u5230\u4f60\u70b9\u51fb\u6700\u540e\u4e00\u4e2a\u6b63\u786e\u6309\u94ae\u8ba1\u65f6\u7ed3\u675f")),E.createElement("div",{className:"content",id:"content__div"},Y.map((function(e,t){return E.createElement(ue,{cols:e,rowIndex:t,key:t})}))),E.createElement(l.Z,{visible:ne,alignCenter:!1,title:"\u6e38\u620f\u5386\u53f2",style:{top:60,width:"60%",minWidth:560},onOk:function(){return ae(!1)},onCancel:function(){return ae(!1)}},E.createElement(ie,null)))}}}]);
//# sourceMappingURL=3.3985e381.chunk.js.map